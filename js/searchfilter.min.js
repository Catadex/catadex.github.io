function doSearch(){catDB=JSON.parse(inDB()),""===window.query&&(window.query=".*");let t=window.query.split(" "),e=[];for(let a=0;a<catDB.data.length;a++)for(let r=0;r<t.length;r++){let l=new RegExp(t[r],"i");l.test(fixQuery(catDB.data[a].name+" "+catDB.data[a].alt+" "+catDB.data[a].year))&&e.push(a)}e=Array.from(new Set(e));let a=e.map(t=>catDB.data[t]),r=document.querySelectorAll("section.filter filter[class*='tags']");for(let t=0;t<r.length;t++){let e=r[t].querySelectorAll("x.active");for(let r=0;r<e.length;r++)qPattern=new RegExp(e[r].getAttribute("data-value"),"i"),a=a.filter(e=>!qPattern.test(e.tags[t]))}catDB.data=a,writeOptions(),writePage(1)}